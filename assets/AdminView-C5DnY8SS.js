import{_ as D,r as d,o as N,c as p,a as t,b as _,d as k,w as I,e as B,t as m,f as F,g as R,h as v,v as b,C as S,F as $,i as j,j as A,k as x,n as w,u as L,l as h,m as y,p as G,q as c,s as M,x as T}from"./index-CSNzbXUJ.js";const z={class:"container py-5"},H={class:"d-flex justify-content-between align-items-center mb-4"},J={class:"card-header"},K={class:"mb-0"},O={class:"card-body"},Q={class:"mb-3"},W={class:"mb-3"},X={class:"mb-3"},Y={class:"mb-3"},Z={class:"mt-4"},ee={class:"d-flex justify-content-center"},te={class:"d-flex gap-2 mt-3"},le={key:0,class:"row g-4"},oe={class:"card"},se={class:"card-body"},ae={class:"d-flex justify-content-between align-items-start"},re=["href"],ie={class:"d-flex gap-2"},ne=["onClick"],de=["onClick"],ce={__name:"AdminView",setup(ue){const f=d([]),l=d({title:"",imageUrl:"",description:"",repoUrl:""}),i=d(null),a=d(""),n=d("success"),u=d(null),g=async()=>{const s=await A(x(y,"projects"));f.value=s.docs.map(e=>({id:e.id,...e.data()}))},V=async()=>{const e=[{key:"title",label:"Nombre del proyecto"},{key:"imageUrl",label:"URL de la imagen"},{key:"repoUrl",label:"Enlace al repositorio"}].find(r=>!l.value[r.key]?.trim());if(e){a.value=`❌ Falta: ${e.label}`,n.value="danger",await w();const r={title:'input[placeholder*="Nombre"], input[placeholder*="Proyecto"]',imageUrl:'input[placeholder*="imagen"]',repoUrl:'input[placeholder*="repositorio"]'};(u.value?.querySelector(r[e.key])||u.value?.querySelector('input[type="text"]'))?.focus();return}try{i.value?(await L(h(y,"projects",i.value),l.value),a.value="✅ Proyecto actualizado"):(await G(x(y,"projects"),l.value),a.value="✅ Proyecto guardado"),n.value="success",U(),await g()}catch(r){console.error("Error al guardar:",r),a.value=`❌ Error: ${r.message?.split("] ")[1]||"Desconocido"}`,n.value="danger"}},q=async s=>{i.value=s.id,l.value={title:s.title||"",imageUrl:s.imageUrl||"",description:s.description||"",repoUrl:s.repoUrl||""},await w(),u.value?.scrollIntoView({behavior:"smooth",block:"start"}),u.value?.querySelector('input[type="text"]')?.focus()},C=()=>{U()},E=async s=>{if(confirm("¿Eliminar este proyecto?"))try{await T(h(y,"projects",s)),a.value="✅ Proyecto eliminado",n.value="success",g()}catch(e){console.error("Error al eliminar:",e),a.value="❌ Error al eliminar",n.value="danger"}},U=()=>{l.value={title:"",imageUrl:"",description:"",repoUrl:""},i.value=null};return N(()=>{g()}),(s,e)=>{const r=B("router-link");return c(),p("div",z,[t("div",H,[e[6]||(e[6]=t("h2",null,"Gestión de Proyectos",-1)),k(r,{to:"/",class:"btn btn-outline-secondary"},{default:I(()=>[...e[5]||(e[5]=[M("← Volver",-1)])]),_:1})]),t("div",{class:"card mb-5",ref_key:"formRef",ref:u},[t("div",J,[t("h3",K,m(i.value?"Editar Proyecto":"Agregar Nuevo Proyecto"),1)]),t("div",O,[a.value?(c(),F(R,{key:0,message:a.value,variant:n.value,"auto-close":3e3,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value="")},null,8,["message","variant"])):_("",!0),t("div",Q,[e[7]||(e[7]=t("label",{class:"form-label"},"Nombre del proyecto",-1)),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.title=o),type:"text",class:"form-control input-required",required:""},null,512),[[b,l.value.title]])]),t("div",W,[e[8]||(e[8]=t("label",{class:"form-label"},"URL de la imagen (pública)",-1)),v(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.imageUrl=o),type:"url",class:"form-control input-required",required:""},null,512),[[b,l.value.imageUrl]]),e[9]||(e[9]=t("div",{class:"form-text"},' Usa una URL directa (ej: desde GitHub → botón "Raw", o ImgBB → "Image link") ',-1))]),t("div",X,[e[10]||(e[10]=t("label",{class:"form-label"},"Descripción",-1)),v(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.description=o),class:"form-control",rows:"3"},null,512),[[b,l.value.description]])]),t("div",Y,[e[11]||(e[11]=t("label",{class:"form-label"},"Enlace al repositorio",-1)),v(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.repoUrl=o),type:"url",class:"form-control input-required",required:""},null,512),[[b,l.value.repoUrl]])]),t("div",Z,[e[12]||(e[12]=t("h4",null,"Vista previa",-1)),t("div",ee,[k(S,{project:{title:l.value.title||"Nombre del proyecto",description:l.value.description||"Descripción del proyecto",repoUrl:l.value.repoUrl||"#",imageUrl:l.value.imageUrl||"https://via.placeholder.com/400x200?text=Sin+imagen"}},null,8,["project"])])]),t("div",te,[t("button",{onClick:V,class:"btn btn-success"},m(i.value?"Actualizar":"Guardar Proyecto"),1),i.value?(c(),p("button",{key:0,onClick:C,class:"btn btn-outline-secondary"}," Cancelar ")):_("",!0)])])],512),f.value.length?(c(),p("div",le,[(c(!0),p($,null,j(f.value,o=>(c(),p("div",{class:"col-12",key:o.id},[t("div",oe,[t("div",se,[t("div",ae,[t("div",null,[t("h5",null,m(o.title),1),t("p",null,m(o.description),1),t("a",{href:o.repoUrl,target:"_blank",class:"text-decoration-none"},m(o.repoUrl),9,re)]),t("div",ie,[t("button",{onClick:P=>q(o),class:"btn btn-sm btn-outline-primary"},"Editar",8,ne),t("button",{onClick:P=>E(o.id),class:"btn btn-sm btn-outline-danger"},"Eliminar",8,de)])])])])]))),128))])):_("",!0)])}}},me=D(ce,[["__scopeId","data-v-0670d34c"]]);export{me as default};
